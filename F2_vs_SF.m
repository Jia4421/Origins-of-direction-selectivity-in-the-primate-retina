clc
clear

% % F1
% % x = [25,50,75,100,125,150,175,200,225,250,275,300,325,350,375,400];
% % x1 = [1/0.025,1/0.050,1/0.075,1/0.100,1/0.125,1/0.150,1/0.175,1/0.200,1/0.225,1/0.250,1/0.275,1/0.300,1/0.325,1/0.350,1/0.375,1/0.400];
% x1 = [1/0.01,1/0.02,1/0.03,1/0.04,1/0.05,1/0.06,1/0.07,1/0.08,1/0.09,1/0.1,1/0.11,1/0.12,1/0.13,1/0.14,1/0.15,1/0.16];
% y1 = [0.025
% 1.020
% 0.390
% 0.120
% 0.233
% 0.160
% 0.117
% 0.097
% 0.078
% 0.062
% 0.050
% 0.043
% 0.038
% 0.035
% 0.032
% 0.030
% ];
% 
% figure
% % plot(x,y,'LineWidth',2.5)
% % semilogx(x,y,'LineWidth',2.5)
% loglog(x1,y1,'LineWidth',2.5)
% xticks([5 10 20 30 40])
% ylabel('1st harmonic amplitude')
% % xlabel('cycle size (um)')
% xlabel('spatial frequency (cycles/mm)')
% title('d349d counterphase grating stimulus')
% % hold on

%F2
% cycle/um * 1000 -> cycle/mm
% x2 = [1/0.025,1/0.050,1/0.075,1/0.100,1/0.125,1/0.150,1/0.175,1/0.200,1/0.225,1/0.250,1/0.275,1/0.300,1/0.325,1/0.350,1/0.375,1/0.400];
% x2 = [1/0.01,1/0.02,1/0.03,1/0.04,1/0.05,1/0.06,1/0.07,1/0.08,1/0.09,1/0.1,1/0.11,1/0.12,1/0.13,1/0.14,1/0.15,1/0.16];
% need more data points at high spatial frequency
% i.e. 5,10,15,20,25,30,35,40,45,50,60,70,80,90,100
% then the same 125,150,175,200,225,250,275,300,325,350,375,400
% remove points 10,20,90,80
%x=0.001*[5,15,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,125,150,175,200,225,250,275,300,325,350,375,400];
x=0.001*[35,40,45,50,55,60,65,70,75,85,100,125,150,175,200,225,250,275,300,350,400];
x2=1:21;
for i=1:length(x)
    x2(i)=1/x(i);
end
x2 = x2*0.205;

y2 = [
0.188
0.516
1.069
1.455
2.065
2.660
3.117
3.480
3.824
4.483
4.852
4.905
4.825
4.782
4.714
4.765
4.872
4.751
4.764
4.775
4.777
];

% y2 = [0.185
% 0.021
% 0.025
% 0.002
% 0.013
% 0.068
% 0.188
% 0.516
% 1.069
% 1.455
% 2.065
% 2.660
% 3.117
% 3.480
% 3.824
% 4.158
% 4.483
% 4.682
% 4.807
% 4.852
% 4.905
% 4.825
% 4.782
% 4.714
% 4.765
% 4.872
% 4.751
% 4.764
% 4.772
% 4.775
% 4.776
% 4.777
% ];

% figure
% semilogx(x,y,'LineWidth',2.5)
semilogx(x2,y2,'-ko','MarkerFaceColor','k','LineWidth',2)
xticks([1 2 4 8 10])
xlim([0 9])
ylim([0 6])
% xticks([0.005 0.01 0.02 0.03 0.04])
% ylabel('2nd harmonic amplitude')
ylabel('F2 Amplitude (mV)')
%xlabel('spatial frequency (cycles/mm)')
xlabel('Spatial Frequency (cpd)')
title('Counterpahse Squarewave Grating')
%legend('F1','F2')
%title('d334 counterphase grating stimulus')
% ylim([0 10]);
% 1cycles/mm * 0.0.205mm/degree = 0.205cycles/degree (cpd) for monkey
% L is the length of one cycle, spatial frequency of the variation of 1/L


% F1/F2 ratio
% y = y2/y1;
% figure
% loglog(x1,y,'LineWidth',2.5)
% xticks([5 10 20 30 40])
% ylabel('F1/F2 ratio')
% xlabel('spatial frequency (cycles/mm)')

%plot voltage responses at 70um and 75um
V1 = [-48.762
-48.8
-48.838
-48.875
-48.912
-48.949
-48.986
-49.022
-49.057
-49.092
-49.127
-49.162
-49.196
-49.23
-49.264
-49.297
-49.33
-49.363
-49.395
-49.427
-49.459
-49.49
-49.521
-49.553
-49.588
-49.625
-49.662
-49.698
-49.73
-49.755
-49.773
-49.781
-49.779
-49.767
-49.745
-49.712
-49.668
-49.613
-49.549
-49.475
-49.392
-49.3
-49.2
-49.092
-48.977
-48.856
-48.729
-48.597
-48.461
-48.32
-48.176
-48.03
-47.881
-47.73
-47.579
-47.426
-47.274
-47.121
-46.97
-46.82
-46.671
-46.524
-46.379
-46.237
-46.097
-45.96
-45.826
-45.695
-45.567
-45.443
-45.322
-45.204
-45.09
-44.98
-44.873
-44.77
-44.671
-44.576
-44.485
-44.398
-44.314
-44.234
-44.159
-44.086
-44.018
-43.954
-43.893
-43.836
-43.782
-43.732
-43.686
-43.643
-43.604
-43.567
-43.535
-43.505
-43.479
-43.455
-43.435
-43.417
-43.403
-43.391
-43.382
-43.376
-43.373
-43.372
-43.373
-43.377
-43.384
-43.392
-43.403
-43.416
-43.431
-43.449
-43.468
-43.489
-43.512
-43.537
-43.563
-43.591
-43.621
-43.652
-43.685
-43.72
-43.756
-43.793
-43.831
-43.871
-43.912
-43.954
-43.997
-44.041
-44.087
-44.133
-44.18
-44.228
-44.277
-44.327
-44.378
-44.429
-44.481
-44.533
-44.587
-44.641
-44.695
-44.75
-44.806
-44.862
-44.918
-44.975
-45.032
-45.09
-45.148
-45.206
-45.264
-45.323
-45.382
-45.441
-45.501
-45.56
-45.62
-45.68
-45.74
-45.799
-45.859
-45.92
-45.979
-46.04
-46.1
-46.16
-46.22
-46.28
-46.339
-46.399
-46.459
-46.518
-46.578
-46.637
-46.696
-46.755
-46.814
-46.872
-46.931
-46.989
-47.047
-47.105
-47.162
-47.219
-47.276
-47.333
-47.39
-47.446
-47.502
-47.558
-47.613
-47.668
-47.723
-47.777
-47.831
-47.885
-47.939
-47.992
-48.045
-48.097
-48.149
-48.201
-48.253
-48.304
-48.355
-48.405
-48.455
-48.505
-48.554
-48.603
-48.652
-48.7
-48.748
-48.795
-48.842
-48.889
-48.935
-48.981
-49.027
-49.072
-49.117
-49.161
-49.205
-49.249
-49.293
-49.335
-49.378
-49.42
-49.462
-49.503
-49.545
-49.585
-49.626
-49.666
-49.705
-49.744
-49.783
-49.822
-49.86
-49.898
-49.935
-49.972
-50.009
-50.045
-50.081
-50.116
-50.152
-50.187
-50.221
-50.255
-50.289
-50.322
-50.355
-50.388
-50.421
-50.453
-50.485
-50.516
-50.547
-50.578
-50.608
-50.638
-50.668
-50.698
-50.727
-50.756
-50.784
-50.812
-50.84
-50.87
-50.901
-50.934
-50.966
-50.995
-51.018
-51.033
-51.037
-51.03
-51.01
-50.978
-50.932
-50.873
-50.801
-50.717
-50.621
-50.513
-50.394
-50.265
-50.126
-49.979
-49.823
-49.66
-49.491
-49.315
-49.135
-48.95
-48.762
-48.571
-48.377
-48.182
-47.986
-47.789
-47.593
-47.397
-47.202
-47.008
-46.817
-46.628
-46.441
-46.258
-46.078
-45.901
-45.727
-45.558
-45.392
-45.23
-45.073
-44.919
-44.77
-44.625
-44.485
-44.349
-44.218
-44.091
-43.969
-43.851
-43.738
-43.63
-43.526
-43.426
-43.331
-43.24
-43.154
-43.072
-42.994
-42.92
-42.851
-42.785
-42.724
-42.666
-42.613
-42.563
-42.517
-42.474
-42.435
-42.4
-42.368
-42.339
-42.313
-42.291
-42.272
-42.255
-42.242
-42.232
-42.224
-42.219
-42.217
-42.217
-42.22
-42.225
-42.233
-42.242
-42.255
-42.269
-42.285
-42.303
-42.324
-42.346
-42.37
-42.396
-42.423
-42.452
-42.483
-42.515
-42.549
-42.584
-42.62
-42.658
-42.697
-42.738
-42.779
-42.822
-42.866
-42.91
-42.956
-43.003
-43.05
-43.099
-43.148
-43.198
-43.249
-43.301
-43.353
-43.406
-43.459
-43.514
-43.568
-43.623
-43.679
-43.735
-43.792
-43.848
-43.906
-43.963
-44.021
-44.079
-44.138
-44.196
-44.255
-44.314
-44.374
-44.433
-44.493
-44.552
-44.612
-44.672
-44.732
-44.792
-44.852
-44.912
-44.971
-45.031
-45.091
-45.151
-45.211
-45.27
-45.33
-45.389
-45.449
-45.508
-45.567
-45.625
-45.684
-45.743
-45.801
-45.859
-45.917
-45.975
-46.032
-46.089
-46.146
-46.203
-46.259
-46.315
-46.371
-46.427
-46.482
-46.537
-46.592
-46.646
-46.701
-46.754
-46.808
-46.861
-46.914
-46.967
-47.019
-47.071
-47.122
-47.174
-47.224
-47.275
-47.325
-47.375
-47.424
-47.474
-47.522
-47.571
-47.619
-47.666
-47.714
-47.761
-47.807
-47.854
-47.899
-47.945
-47.99
-48.035
-48.079
-48.123
-48.167
-48.21
-48.253
-48.296
-48.338
-48.38
-48.421
-48.462
-48.503
-48.544
-48.584
-48.623
-48.663
-48.702
-48.74
-48.778
-48.816
];
V2 = [-48.598
-48.638
-48.678
-48.717
-48.756
-48.795
-48.833
-48.871
-48.908
-48.945
-48.982
-49.018
-49.055
-49.09
-49.125
-49.16
-49.195
-49.229
-49.263
-49.296
-49.329
-49.362
-49.394
-49.428
-49.465
-49.505
-49.547
-49.587
-49.624
-49.654
-49.675
-49.688
-49.689
-49.678
-49.655
-49.62
-49.572
-49.511
-49.439
-49.355
-49.26
-49.155
-49.04
-48.916
-48.784
-48.644
-48.497
-48.345
-48.187
-48.025
-47.859
-47.69
-47.519
-47.346
-47.172
-46.998
-46.824
-46.65
-46.478
-46.308
-46.139
-45.974
-45.811
-45.651
-45.496
-45.343
-45.195
-45.05
-44.91
-44.774
-44.642
-44.515
-44.392
-44.274
-44.16
-44.051
-43.946
-43.846
-43.751
-43.66
-43.573
-43.492
-43.414
-43.341
-43.272
-43.208
-43.147
-43.091
-43.039
-42.991
-42.947
-42.906
-42.87
-42.837
-42.808
-42.782
-42.759
-42.74
-42.724
-42.712
-42.702
-42.696
-42.692
-42.692
-42.694
-42.698
-42.706
-42.716
-42.728
-42.743
-42.759
-42.779
-42.8
-42.824
-42.849
-42.877
-42.906
-42.937
-42.97
-43.005
-43.041
-43.079
-43.118
-43.159
-43.201
-43.245
-43.29
-43.336
-43.383
-43.431
-43.481
-43.532
-43.583
-43.636
-43.689
-43.743
-43.798
-43.854
-43.911
-43.968
-44.026
-44.084
-44.144
-44.203
-44.263
-44.324
-44.385
-44.447
-44.509
-44.571
-44.634
-44.697
-44.76
-44.823
-44.887
-44.951
-45.015
-45.079
-45.144
-45.208
-45.273
-45.337
-45.402
-45.467
-45.532
-45.596
-45.661
-45.726
-45.79
-45.854
-45.919
-45.983
-46.047
-46.111
-46.175
-46.239
-46.303
-46.366
-46.429
-46.492
-46.555
-46.617
-46.679
-46.741
-46.803
-46.865
-46.926
-46.987
-47.047
-47.108
-47.168
-47.227
-47.287
-47.346
-47.405
-47.463
-47.521
-47.579
-47.636
-47.693
-47.75
-47.806
-47.862
-47.917
-47.972
-48.027
-48.081
-48.135
-48.189
-48.242
-48.295
-48.348
-48.399
-48.451
-48.502
-48.553
-48.604
-48.654
-48.703
-48.752
-48.801
-48.849
-48.897
-48.945
-48.992
-49.039
-49.085
-49.131
-49.177
-49.222
-49.266
-49.311
-49.355
-49.398
-49.441
-49.484
-49.526
-49.568
-49.61
-49.651
-49.692
-49.732
-49.772
-49.811
-49.85
-49.889
-49.928
-49.966
-50.003
-50.04
-50.077
-50.114
-50.15
-50.186
-50.221
-50.256
-50.29
-50.325
-50.359
-50.392
-50.425
-50.458
-50.491
-50.523
-50.554
-50.586
-50.617
-50.648
-50.678
-50.708
-50.738
-50.767
-50.796
-50.827
-50.859
-50.891
-50.922
-50.947
-50.963
-50.968
-50.959
-50.935
-50.895
-50.839
-50.766
-50.678
-50.574
-50.455
-50.323
-50.177
-50.019
-49.85
-49.671
-49.482
-49.286
-49.082
-48.871
-48.656
-48.437
-48.213
-47.988
-47.76
-47.532
-47.303
-47.074
-46.847
-46.621
-46.397
-46.175
-45.957
-45.742
-45.531
-45.325
-45.122
-44.925
-44.732
-44.545
-44.362
-44.185
-44.013
-43.846
-43.685
-43.529
-43.379
-43.235
-43.096
-42.962
-42.834
-42.711
-42.593
-42.481
-42.375
-42.273
-42.177
-42.085
-41.999
-41.918
-41.841
-41.769
-41.702
-41.639
-41.581
-41.527
-41.477
-41.432
-41.39
-41.353
-41.319
-41.289
-41.263
-41.24
-41.221
-41.206
-41.193
-41.184
-41.178
-41.175
-41.175
-41.177
-41.183
-41.191
-41.202
-41.215
-41.231
-41.249
-41.269
-41.292
-41.317
-41.343
-41.372
-41.403
-41.436
-41.47
-41.506
-41.544
-41.583
-41.624
-41.666
-41.71
-41.755
-41.801
-41.849
-41.898
-41.948
-41.999
-42.051
-42.105
-42.159
-42.214
-42.27
-42.326
-42.384
-42.442
-42.501
-42.561
-42.621
-42.682
-42.743
-42.805
-42.868
-42.931
-42.994
-43.058
-43.122
-43.186
-43.251
-43.316
-43.381
-43.447
-43.513
-43.578
-43.645
-43.711
-43.777
-43.843
-43.91
-43.976
-44.043
-44.109
-44.176
-44.242
-44.309
-44.375
-44.441
-44.507
-44.573
-44.639
-44.705
-44.771
-44.836
-44.902
-44.967
-45.032
-45.096
-45.161
-45.225
-45.289
-45.353
-45.417
-45.48
-45.543
-45.606
-45.668
-45.73
-45.792
-45.853
-45.914
-45.975
-46.036
-46.096
-46.156
-46.215
-46.274
-46.333
-46.391
-46.449
-46.507
-46.564
-46.621
-46.678
-46.734
-46.789
-46.845
-46.9
-46.954
-47.009
-47.062
-47.116
-47.169
-47.221
-47.273
-47.325
-47.376
-47.427
-47.478
-47.528
-47.577
-47.627
-47.676
-47.724
-47.772
-47.82
-47.867
-47.914
-47.96
-48.006
-48.051
-48.097
-48.141
-48.186
-48.23
-48.273
-48.316
-48.359
-48.402
-48.444
-48.485
-48.526
-48.567
-48.607
-48.647
];

t = 0:0.001:1.001;
figure
V1 = [V1;V1];
plot(t,V1,'-k','MarkerFaceColor','k','LineWidth',2)
xlim([0 1])
ylim([-52 -38])
xlabel('time(s)')
ylabel('Voltage(mV)')
title('2.93 cpd')

figure
V2 = [V2;V2];
plot(t,V2,'-k','MarkerFaceColor','k','LineWidth',2)
xlim([0 1])
ylim([-52 -38])
xlabel('time(s)')
ylabel('Voltage(mV)')
title('2.73 cpd')


 